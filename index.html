<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>1æ—¥1ãƒšãƒ¼ã‚¸ã‚¿ã‚¹ã‚¯ç®¡ç†</title>
<style>
  body {
    font-family: sans-serif;
    padding: 20px;
    background: #fafafa;
  }
  h1 {
    text-align: center; 
    margin-bottom: 20px;
  }
  h2 {
    margin-top: 25px;
    border-left: 6px solid #4CAF50;
    padding-left: 10px;
  }
  .task-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px 20px;
    margin-bottom: 10px;
  }
  .task {
    text-align: center;
  }
  .task-btn {
    padding: 10px 16px;
    background: #e0f7fa;
    border-radius: 8px;
    cursor: pointer;
    border: 1px solid #aaa;
    min-width: 80px;
  }
  .task-btn:hover {
    background: #b2ebf2;
  }
  .date-label {
    font-size: 12px;
    color: #555;
    margin-top: 2px;
    text-align: left;
  }
</style>
</head>
<body>

<h1 id="dateDisplay"></h1>

<!-- ===== ãã†ã˜ã ===== -->
<h2>ãã†ã˜ã</h2>
<div class="task-group">
  <div class="task"><div class="task-btn" onclick="doneTask('ãã†ã˜ã','ãƒªãƒ“ãƒ³ã‚°')">ãƒªãƒ“ãƒ³ã‚°</div><div class="date-label" id="label-ãã†ã˜ã-ãƒªãƒ“ãƒ³ã‚°"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('ãã†ã˜ã','ã‚ã†ã‹')">ã‚ã†ã‹</div><div class="date-label" id="label-ãã†ã˜ã-ã‚ã†ã‹"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('ãã†ã˜ã','ç„é–¢')">ç„é–¢</div><div class="date-label" id="label-ãã†ã˜ã-ç„é–¢"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('ãã†ã˜ã','ç›´ã®éƒ¨å±‹')">ç›´ã®éƒ¨å±‹</div><div class="date-label" id="label-ãã†ã˜ã-ç›´ã®éƒ¨å±‹"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('ãã†ã˜ã','2ç•ª')">2ç•ª</div><div class="date-label" id="label-ãã†ã˜ã-2ç•ª"></div></div>
</div>

<!-- ===== æ´—ã„ ===== -->
<h2>æ¸…æƒ</h2>
<div class="task-group">
  <div class="task"><div class="task-btn" onclick="doneTask('æ´—ã„','ã‚­ãƒƒãƒãƒ³')">ã‚­ãƒƒãƒãƒ³</div><div class="date-label" id="label-æ´—ã„-ã‚­ãƒƒãƒãƒ³"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ´—ã„','æ´—é¢æ‰€')">æ´—é¢æ‰€</div><div class="date-label" id="label-æ´—ã„-æ´—é¢æ‰€"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ´—ã„','é¢¨å‘‚')">é¢¨å‘‚</div><div class="date-label" id="label-æ´—ã„-é¢¨å‘‚"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ´—ã„','ãƒˆã‚¤ãƒ¬')">ãƒˆã‚¤ãƒ¬</div><div class="date-label" id="label-æ´—ã„-ãƒˆã‚¤ãƒ¬"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ´—ã„','æ´—æ¿¯æ©Ÿ')">æ´—æ¿¯æ©Ÿ</div><div class="date-label" id="label-æ´—ã„-æ´—æ¿¯æ©Ÿ"></div></div>
</div>

<!-- ===== äº¤æ› ===== -->
<h2>äº¤æ›ï¼ˆæ’æ°´æºãƒãƒƒãƒˆãªã©ï¼‰</h2>
<div class="task-group">
  <div class="task"><div class="task-btn" onclick="doneTask('äº¤æ›','ã‚­ãƒƒãƒãƒ³')">ã‚­ãƒƒãƒãƒ³</div><div class="date-label" id="label-äº¤æ›-ã‚­ãƒƒãƒãƒ³"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('äº¤æ›','æ´—é¢æ‰€')">æ´—é¢æ‰€</div><div class="date-label" id="label-äº¤æ›-æ´—é¢æ‰€"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('äº¤æ›','é¢¨å‘‚')">é¢¨å‘‚</div><div class="date-label" id="label-äº¤æ›-é¢¨å‘‚"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('äº¤æ›','ã‚¹ãƒãƒ³ã‚¸')">ã‚¹ãƒãƒ³ã‚¸</div><div class="date-label" id="label-äº¤æ›-ã‚¹ãƒãƒ³ã‚¸"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('äº¤æ›','æµ„æ°´')">æµ„æ°´</div><div class="date-label" id="label-äº¤æ›-æµ„æ°´"></div></div>
</div>

<!-- ===== æ‹­ãæƒé™¤ ===== -->
<h2>æ‹­ãæƒé™¤</h2>
<div class="task-group">
  <div class="task"><div class="task-btn" onclick="doneTask('æ‹­ãæƒé™¤','ãƒ€ã‚¤ãƒ‹ãƒ³ã‚°')">ãƒ€ã‚¤ãƒ‹ãƒ³ã‚°</div><div class="date-label" id="label-æ‹­ãæƒé™¤-ãƒ€ã‚¤ãƒ‹ãƒ³ã‚°"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ‹­ãæƒé™¤','ã‚­ãƒƒãƒãƒ³æ£š')">ã‚­ãƒƒãƒãƒ³æ£š</div><div class="date-label" id="label-æ‹­ãæƒé™¤-ã‚­ãƒƒãƒãƒ³æ£š"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ‹­ãæƒé™¤','å†·è”µåº«')">å†·è”µåº«</div><div class="date-label" id="label-æ‹­ãæƒé™¤-å†·è”µåº«"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ‹­ãæƒé™¤','ãƒªãƒ“ãƒ³ã‚°çª“')">ãƒªãƒ“ãƒ³ã‚°çª“</div><div class="date-label" id="label-æ‹­ãæƒé™¤-ãƒªãƒ“ãƒ³ã‚°çª“"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ‹­ãæƒé™¤','ç›´ã®éƒ¨å±‹çª“')">ç›´ã®éƒ¨å±‹çª“</div><div class="date-label" id="label-æ‹­ãæƒé™¤-ç›´ã®éƒ¨å±‹çª“"></div></div>
  <div class="task"><div class="task-btn" onclick="doneTask('æ‹­ãæƒé™¤','2ç•ªçª“')">2ç•ªçª“</div><div class="date-label" id="label-æ‹­ãæƒé™¤-2ç•ªçª“"></div></div>
</div>

<h2>ä»Šæ—¥ã®æ°—åˆ†</h2>
<div id="moodArea" style="font-size: 30px; margin-bottom: 10px;">
  <span class="mood" data-mood="good" style="cursor:pointer;">ğŸ™‚</span>
  <span class="mood" data-mood="normal" style="cursor:pointer;">ğŸ˜</span>
  <span class="mood" data-mood="bad" style="cursor:pointer;">ğŸ˜£</span>
</div>

<h2>ä»Šæ—¥ã®æ°—ã¥ã</h2>
<textarea id="memoShort" rows="3"
  style="width:100%; font-size:14px;"></textarea>

<h2>ä»Šæ—¥ã®æ—¥è¨˜</h2>
<textarea id="memoLong" rows="8"
  style="width:100%; font-size:14px; background:#fff8dc;"></textarea>

  
<script>
let currentDate = new Date();

function formatDate(d) {
  const w = ["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"];
  return `${d.getFullYear()}å¹´${d.getMonth()+1}æœˆ${d.getDate()}æ—¥ï¼ˆ${w[d.getDay()]}ï¼‰`;
}

function loadPage() {
  document.getElementById("dateDisplay").textContent = formatDate(currentDate);

  const key = currentDate.toISOString().slice(0,10);
  const data = JSON.parse(localStorage.getItem(key) || "{}");

  document.querySelectorAll(".date-label").forEach(label => label.textContent = "");

  for (const id in data) {
    const label = document.getElementById("label-" + id);
    if (label) label.textContent = data[id];
  }
}

function doneTask(category, item) {
  const key = currentDate.toISOString().slice(0,10);
  const data = JSON.parse(localStorage.getItem(key) || "{}");

  const todayStr = `${currentDate.getMonth()+1}/${currentDate.getDate()}`;
  const id = `${category}-${item}`;
  const label = document.getElementById("label-" + id);

  // ã™ã§ã«åŒã˜æ—¥ä»˜ãŒå…¥ã£ã¦ã„ãŸã‚‰ã€Œå–ã‚Šæ¶ˆã—ã€
  if (data[id] === todayStr) {
    delete data[id];
    if (label) label.textContent = "";
  } else {
    // æ–°ã—ãç™»éŒ² or ä¸Šæ›¸ã
    data[id] = todayStr;
    if (label) label.textContent = todayStr;
  }

  localStorage.setItem(key, JSON.stringify(data));
}

let startX = 0;
document.body.addEventListener("touchstart", e => startX = e.touches[0].clientX);
document.body.addEventListener("touchend", e => {
  const endX = e.changedTouches[0].clientX;
  if (endX - startX > 80) {
    currentDate.setDate(currentDate.getDate() - 1);
    loadPage();
  } else if (startX - endX > 80) {
    currentDate.setDate(currentDate.getDate() + 1);
    loadPage();
  }
});

loadPage();

// â˜… ãƒ¡ãƒ¢ã®èª­ã¿è¾¼ã¿
function loadMemo() {
  const key = currentDate.toISOString().slice(0,10);
  const memo = JSON.parse(localStorage.getItem("memo-" + key) || "{}");

  document.getElementById("memoShort").value = memo.short || "";
  document.getElementById("memoLong").value = memo.long || "";

  // æ°—åˆ†ã®åæ˜ 
  currentMood = memo.mood || null;
  document.querySelectorAll(".mood").forEach(m => m.style.opacity = 0.3);
  if (currentMood) {
    const selected = document.querySelector(`.mood[data-mood="${currentMood}"]`);
    if (selected) selected.style.opacity = 1;
  }
}

// â˜… ãƒ¡ãƒ¢ã®ä¿å­˜ï¼ˆè‡ªå‹•ï¼‰
function saveMemo() {
  const key = currentDate.toISOString().slice(0,10);
  const memo = {
    short: document.getElementById("memoShort").value,
    long: document.getElementById("memoLong").value,
    mood: currentMood
  };
  localStorage.setItem("memo-" + key, JSON.stringify(memo));
}

// â˜… æ°—åˆ†é¸æŠ
let currentMood = null;
document.querySelectorAll(".mood").forEach(m => {
  m.addEventListener("click", () => {
    currentMood = m.dataset.mood;

    // è¦‹ãŸç›®ã®æ›´æ–°
    document.querySelectorAll(".mood").forEach(x => x.style.opacity = 0.3);
    m.style.opacity = 1;

    saveMemo();
  });
});

// â˜… æ°—ã¥ãæ¬„ã«ã€Œãƒ»ã€è‡ªå‹•æŒ¿å…¥
document.getElementById("memoShort").addEventListener("input", function(e) {
  let text = this.value;

  // å…¥åŠ›é–‹å§‹æ™‚ã«ã€Œãƒ»ã€ã‚’ä»˜ã‘ã‚‹
  if (text.length === 1 && text !== "ãƒ»") {
    this.value = "ãƒ»" + text;
  }

  // æ”¹è¡Œã”ã¨ã«ã€Œãƒ»ã€ã‚’ä»˜ã‘ã‚‹
  this.value = this.value.replace(/\n(?!ãƒ»)/g, "\nãƒ»");

  saveMemo();
});

// â˜… æ—¥è¨˜æ¬„ã‚‚è‡ªå‹•ä¿å­˜
document.getElementById("memoLong").addEventListener("input", saveMemo);

// â˜… ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ¡ãƒ¢ã‚‚èª­ã¿è¾¼ã‚€
const originalLoadPage = loadPage;
loadPage = function() {
  originalLoadPage();
  loadMemo();
};
  
</script>

</body>

</html>
